<%- include('../partials/admin_header', { pageTitle: 'Messages' }) %>

<h1 class="mb-4">User Messages</h1>

<% if (messages.length === 0) { %>
  <div class="alert alert-info">No messages yet.</div>
<% } else { %>
  <div class="table-responsive">
    <table class="table table-striped">
  <thead>
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Email</th>
      <th>Phone</th>
      <th>Message</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% messages.forEach(msg => { %>
      <tr>
        <td><%= msg.firstName %></td>
        <td><%= msg.lastName %></td>
        <td><%= msg.email %></td>
        <td><%= msg.phoneNumber %></td>
        <td><%= msg.message %></td>
        <td><%= msg.read ? 'âœ… Read' : 'ğŸ“© Unread' %></td>
        <td>
          <% if (msg.read) { %>
            <form action="/admin/messages/toggle/<%= msg._id %>" method="POST">
              <button type="submit" class="btn btn-sm btn-warning">Mark Unread</button>
            </form>
          <% } else { %>
            <form action="/admin/messages/toggle/<%= msg._id %>" method="POST">
              <button type="submit" class="btn btn-sm btn-success">Mark Read</button>
            </form>
          <% } %>

          <form action="/admin/messages/delete/<%= msg._id %>" method="POST" onsubmit="return confirm('Delete this message?');">
            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
          </form>
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>
   
  </div>
<% } %>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<%- include('../partials/admin_footer') %>
